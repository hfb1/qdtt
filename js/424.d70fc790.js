"use strict";(self["webpackChunkhtqdtt"]=self["webpackChunkhtqdtt"]||[]).push([[424],{715:function(n,t,e){e.r(t),e.d(t,{default:function(){return w}});var s=function(){var n=this,t=n._self._c;return t("div",[t("div",[t("van-nav-bar",{attrs:{fixed:""},scopedSlots:n._u([{key:"left",fn:function(){return[t("img",{staticClass:"logo",attrs:{src:e(6949),alt:""}})]},proxy:!0},{key:"right",fn:function(){return[t("van-icon",{attrs:{name:"search",size:"0.48rem",color:"#fff"},on:{click:n.moveSearchPagesFn}})]},proxy:!0}])})],1),t("div",{staticClass:"main"},[t("van-tabs",{attrs:{animated:"",sticky:"","offset-top":"1.226667rem"},on:{change:n.TabsChangeFn},model:{value:n.channelId,callback:function(t){n.channelId=t},expression:"channelId"}},n._l(n.userChannelList,(function(e){return t("van-tab",{key:e.id,attrs:{title:e.name,name:e.id}},[t("ArticleList",{attrs:{channelId:n.channelId}})],1)})),1),t("van-icon",{staticClass:"moreChannels",attrs:{name:"plus",size:"0.37333334rem"},on:{click:n.plusClickFn}})],1),t("van-popup",{staticClass:"channel_popup",attrs:{"get-container":"body"},model:{value:n.show,callback:function(t){n.show=t},expression:"show"}},[t("ChannelEdit",{ref:"editRef",attrs:{userList:n.userChannelList,unCheckList:n.unChannelList},on:{addChannelEV:n.addChannelFn,removeChannelEV:n.removeChannelFn,closeEv:n.closeFn,changeChannelEV:n.changeChannelFn}})],1)],1)},i=[],a=e(586),l=function(){var n=this,t=n._self._c;return t("div",[t("van-pull-refresh",{on:{refresh:n.onRefresh},model:{value:n.isLoading,callback:function(t){n.isLoading=t},expression:"isLoading"}},[t("van-list",{attrs:{finished:n.finished,"finished-text":"没有更多了","immediate-check":!1,offset:"50"},on:{load:n.onLoad},model:{value:n.loading,callback:function(t){n.loading=t},expression:"loading"}},n._l(n.list,(function(e){return t("ArtileItem",{key:e.art_id,attrs:{artObj:e},on:{disLikeEV:n.disLikeFn,reportsEV:n.reportsFn},nativeOn:{click:function(t){return n.itemClickFn(e.art_id)}}})})),1)],1)],1)},c=[],r=e(3449),o=e(4623),h={props:{channelId:Number},data(){return{list:[],loading:!1,finished:!1,theTime:(new Date).getTime(),isLoading:!1}},components:{ArtileItem:r.Z},async created(){this.getArticleListFn()},methods:{async getArticleListFn(){const{data:n}=await(0,a.WC)({channel_id:this.channelId,timestamp:this.theTime});console.log("获取文章列表",n),this.list=[...this.list,...n.data.results],this.theTime=n.data.pre_timestamp,this.loading=!1,null===n.data.pre_timestamp&&(this.finished=!0),this.isLoading=!1},async onLoad(){0!==this.list.length?this.getArticleListFn():this.loading=!1},async onRefresh(){this.list=[],this.theTime=(new Date).getTime(),this.getArticleListFn()},async disLikeFn(n){try{await(0,a.c0)({artId:n}),(0,o.Z)({type:"success",message:"反馈成功"})}catch(t){(0,o.Z)({type:"warning",message:"举报失败"})}},async reportsFn(n,t){try{await(0,a.gk)({artId:n,type:t,remark:"就是其他问题"}),(0,o.Z)({type:"success",message:"举报成功"})}catch(e){(0,o.Z)({type:"warning",message:"举报失败"})}},itemClickFn(n){this.$router.push({path:`/detail?art_id=${n}`})}}},d=h,u=e(1001),m=(0,u.Z)(d,l,c,!1,null,null,null),p=m.exports,f=function(){var n=this,t=n._self._c;return t("div",[t("van-nav-bar",{attrs:{title:"频道管理"},scopedSlots:n._u([{key:"right",fn:function(){return[t("van-icon",{attrs:{name:"cross",size:"0.37333334rem",color:"white"},on:{click:n.closeFn}})]},proxy:!0}])}),t("div",{staticClass:"my-channel-box"},[t("div",{staticClass:"channel-title"},[t("span",[n._v(" 我的频道 "),t("span",{staticClass:"small-title"},[n._v(" 点击"+n._s(n.isEdit?"删除":"进入")+"频道 ")])]),t("span",{on:{click:n.editFn}},[n._v(n._s(n.isEdit?"完成":"编辑"))])]),t("van-row",{attrs:{type:"flex"}},n._l(n.userList,(function(e){return t("van-col",{key:e.id,attrs:{span:"6"},on:{click:function(t){return n.userChannelFn(e)}}},[t("div",{staticClass:"channel-item van-hairline--surround"},[n._v(" "+n._s(e.name)+" "),t("van-badge",{directives:[{name:"show",rawName:"v-show",value:n.isEdit&&e.id,expression:"isEdit && obj.id"}],staticClass:"cross-badge",attrs:{color:"transparent"},scopedSlots:n._u([{key:"content",fn:function(){return[t("van-icon",{staticClass:"badge-icon",attrs:{name:"cross",color:"#cfcfcf",size:"0.32rem"}})]},proxy:!0}],null,!0)})],1)])})),1)],1),t("div",{staticClass:"more-channel-box"},[n._m(0),t("van-row",{attrs:{type:"flex"}},n._l(n.unCheckList,(function(e){return t("van-col",{key:e.id,attrs:{span:"6"},on:{click:function(t){return n.moreFn(e)}}},[t("div",{staticClass:"channel-item van-hairline--surround"},[n._v(n._s(e.name))])])})),1)],1)],1)},v=[function(){var n=this,t=n._self._c;return t("div",{staticClass:"channel-title"},[t("span",[n._v("点击添加更多频道：")])])}],C={data(){return{isEdit:!1}},props:{userList:Array,unCheckList:Array},methods:{editFn(){this.isEdit=!this.isEdit},moreFn(n){!0===this.isEdit&&this.$emit("addChannelEV",n)},userChannelFn(n){!0===this.isEdit?0!==n.id&&this.$emit("removeChannelEV",n):this.$emit("changeChannelEV",n)},closeFn(){this.$emit("closeEv",this.isEdit)}}},g=C,k=(0,u.Z)(g,f,v,!1,null,"2c5a8060",null),L=k.exports,y={name:"Home",data(){return{channelId:0,userChannelList:[],allChannelList:[],show:!1,channelScrollTObj:{}}},methods:{TabsChangeFn(){this.$nextTick((()=>{document.documentElement.scrollTop=this.channelScrollTObj[this.channelId]}))},async getChannels(){const{data:n}=await(0,a.lS)();console.log("用户频道：",n),this.userChannelList=n.data.channels},plusClickFn(){this.show=!0},async getAllChannels(){const{data:n}=await(0,a.Of)();this.allChannelList=n.data.channels},async addChannelFn(n){this.userChannelList.push(n);const t=this.userChannelList.filter((n=>0!==n.id)),e=t.map(((n,t)=>{const e={...n};return delete e.name,e.seq=t,e})),s=await(0,a.w0)({channels:e});console.log("更新用户频道：",s)},async removeChannelFn(n){const t=this.userChannelList.findIndex((t=>t.id===n.id));this.userChannelList.splice(t,1);const e=await(0,a.i0)({channelId:n.id});console.log("删除选择频道的返回：",e)},closeFn(){this.show=!1,this.$refs.editRef.isEdit=!1},changeChannelFn(n){this.show=!1,this.channelId=n.id},moveSearchPagesFn(){this.$router.push("/search")},scrollFn(){this.$route.meta.scrollT=document.documentElement.scrollTop,this.channelScrollTObj[this.channelId]=document.documentElement.scrollTop}},computed:{unChannelList(){const n=this.allChannelList.filter((n=>{const t=this.userChannelList.findIndex((t=>t.id===n.id));return!(t>-1)}));return n}},created(){this.getChannels(),this.getAllChannels()},activated(){console.log(this.$route),window.addEventListener("scroll",this.scrollFn),document.documentElement.scrollTop=this.$route.meta.scrollT},deactivated(){window.removeEventListener("scroll",this.scrollFn)},components:{ArticleList:p,ChannelEdit:L}},F=y,_=(0,u.Z)(F,s,i,!1,null,"f7286478",null),w=_.exports},6949:function(n,t,e){n.exports=e.p+"img/logo.9cf3123b.png"}}]);
//# sourceMappingURL=424.d70fc790.js.map